(function(e){e.fn.babble=function(t){return{placeholder:null,request:null,list:null,queue:null,latest:null,settings:{username:["sheilaellen"],avatar_size:null,count:3,messages:{fetching:"Fetching tweets...",loading:"...loading tweets,"},delay:20,query:null,running:!1},init:function(){this.configure(),this.request=this.formulate_request()},configure:function(){t&&(this.settings=e.extend(this.settings,t)),this.autoAdjust()},autoAdjust:function(){var t=e(".tweets"),n=e(t).position().top,r=e(window).height(),i=e(document).height(),s=r;i>s&&(s=i);var o=s-n;if(o>0){var u=o+"px";e(t).css("height",u)}},notify:function(t){if(t){e(".status").remove();var n=e('<p class="status">'+t+"</p>");return e(this.placeholder).append(n),n}return null},formulate_request:function(){var e="";this.settings.query!==null&&(e+="q="+this.settings.query),e+="&q=from:"+this.settings.username;var t="http://search.twitter.com/search.json?"+e+"&rpp="+this.settings.count+"&callback=?";return t},fetch:function(){setTimeout("babbler.fetch()",25e3);var t=this,n=this.notify(this.settings.messages.fetching);e.getJSON(this.request,function(e){t.display(t.process_response(e))})},process_response:function(t){var n=this,r=this.notify(this.settings.messages.loading),i=Array(),s=function(t){e.fn.extend({linkUrl:function(){var t=[],n=/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/gi;return this.each(function(){t.push(this.replace(n,'<a href="$1">$1</a>'))}),e(t)},linkUser:function(){var t=[],n=/[\@]+([A-Za-z0-9-_]+)/gi;return this.each(function(){t.push(this.replace(n,'<a href="http://twitter.com/$1">@$1</a>'))}),e(t)},linkHash:function(){var t=[],r=/ [\#]+([A-Za-z0-9-_]+)/gi;return this.each(function(){t.push(this.replace(r,' <a href="http://search.twitter.com/search?q=&tag=$1&lang=all&from='+n.settings.username+"%2BOR%2B"+'">#$1</a>'))}),e(t)}});var r=function(e){var t=Date.parse(e),n=arguments.length>1?arguments[1]:new Date,r=parseInt((n.getTime()-t)/1e3,10);return r<60?"less than a minute ago":r<120?"about a minute ago":r<2700?parseInt(r/60,10).toString()+" minutes ago":r<5400?"about an hour ago":r<86400?"about "+parseInt(r/3600,10).toString()+" hours ago":r<172800?"1 day ago":parseInt(r/86400,10).toString()+" days ago"},i='<p class="avatar"><a href="http://twitter.com/'+t.from_user+'"><img src="'+t.profile_image_url+'" height="'+n.settings.avatar_size+'" width="'+n.settings.avatar_size+'" alt="'+t.from_user+'\'s avatar" border="0"/></a></p>',s=n.settings.avatar_size?i:"",o='<span class="tweeter">'+t.from_user+"</span>",u='<span class="delimiter">: </span>',a='<p class="when"><a href="http://twitter.com/'+t.from_user+"/statuses/"+t.id+'" title="view tweet on twitter">'+r(t.created_at)+"</a></p>",f='<span class="body">'+e([t.text]).linkUrl().linkUser().linkHash()[0]+"</span>",l='<p class="message">'+o+u+f+"</p>",c='<li class="tweet">'+s+l+a+"</li>";return c};return e.each(t.results,function(e,t){var n=s(t);i.push(n)}),i},display:function(t){var n=this;this.list===null&&(this.list=e("<ul>").appendTo(e(this.placeholder))),e(".status").remove();for(var r=t.length-1;r>=0;r--){var i=t[r];e(i).css("display","none"),this.list.prepend(i),e(i).fadeIn("slow")}},run:function(e){this.placeholder=e,this.init(),this.fetch()}}}})(jQuery);