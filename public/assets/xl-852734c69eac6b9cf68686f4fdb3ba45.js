// Automatic page refresh
function refresh(){window.location.reload(!1)}(function(e){e.fn.flypost=function(t){var n=function(t,n){e(t).find(".slot").each(function(){var t=this,r=e(t).attr("id"),i=r.substr(5,r.length),s=function(t){var r=null;return e.each(n.timeslot.slots,function(e,n){n.id==t&&(r=n)}),r},o=s(i),u={title:"Empty",parent:null,reset:function(){e(this.parent).hasClass("talk")&&e(this.parent).addClass("empty").removeClass("talk"),e(this.parent).find(".speaker").remove(),e(this.parent).find(".description").remove(),e(this.parent).find(".title").remove()},insert:function(t){this.parent=t,this.reset(),e(this.parent).append('<p class="heading title">'+this.title+"</p>")}},a=function(){return{id:null,title:null,speaker:null,description:null,url:null,parent:null,populate:function(e){return e!==null&&(this.id=e.id,this.title=e.title,this.speaker=e.speaker,this.description=e.description,this.url=e.url),this},reconstruct:function(t){return this.parent=t,this.parent!==null&&this.parent!=="undefined"&&(this.id=e(this.parent).attr("id"),this.title=e(this.parent).find(".title").text(),this.speaker=e(this.parent).find(".speaker").text(),this.description=e(this.parent).find(".description").text(),this.url=e(this.parent).find(".title a").attr("href")),this},equals:function(e){return this.id==e.id&&this.talk==e.talk&&this.speaker==e.speaker&&this.description==e.description?!0:!1},reset:function(){e(this.parent).hasClass("empty")&&e(this.parent).addClass("talk").removeClass("empty"),e(this.parent).find(".speaker").remove(),e(this.parent).find(".description").remove(),e(this.parent).find(".title").remove()},insert:function(t){this.parent=t,this.reset(),this.title!==null&&e.trim(this.title)!=""&&e(this.parent).append('<p class="heading title"><a>'+this.title+"</a></p>"),this.description!==null&&e.trim(this.description)!=""&&e(this.parent).append('<div class="description">'+this.description+"</div>"),this.speaker!==null&&e.trim(this.speaker)!=""&&e(this.parent).append('<h3 class="heading speaker">'+this.speaker+"</h3>"),this.title}}};if(o===null){refresh();return}e(t).children(".empty").length>0?o.talk_id&&o.talk_id!==null&&e(t).children(".empty").each(function(){var e=(new a).populate(o.talk).insert(this)}):o.talk_id===null?e(t).children(".talk").each(function(){var e=(new u).insert(this)}):e(t).children(".talk").each(function(){var e=(new a).populate(o.talk),t=(new a).reconstruct(this);e.equals(t)||e.insert(this)})})},r=function(t){var r={now:"http://bcl9grid.heroku.com/s/grid/now.json",next:"http://bcl9grid.heroku.com/s/grid/next.json"},i=null;e(t).hasClass("now")?i=r.now:e(t).hasClass("next")&&(i=r.next);if(i!==null)var s=e.getJSON(i,function(e){n(t,e)})};r(t)},e.fn.adjustToFit=function(){var t=this,n=e(t).height(),r=e(window).height(),i=e(document).height(),s=r;i>s&&(s=i);var o=s-n,u=o/2;if(u>0){var a=u+"px";e(t).css("top",a)}},e.fn.blade=function(t){var n={whats_on:{columns:1}},r=null,i=null,s=function(){o(),r=e(".grid .whats-on").filter(".visible"),i=e(".grid .whats-on").filter(".invisible");if(i===null&&e(".main > p.message")){var t=e(".main > p.message"),n=e(t).clone();e(".grid .whats-on").append(n),e(t).remove()}e(i).adjustToFit()},o=function(){t&&(this.settings=e.extend(n,t))},u=function(){e(r).animate({opacity:0},2500),e(i).animate({opacity:1},2500),e(r).removeClass("visible").addClass("invisible"),e(i).removeClass("invisible").addClass("visible"),setTimeout("$(this).blade()",3e4)};this.each(function(){s(),e.fn.flypost(i),u()})},e(document).ready(function(){setTimeout("refresh()",6e4)})})(jQuery);